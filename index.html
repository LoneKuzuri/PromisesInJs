<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Comic+Neue&family=Poppins:wght@400;600&display=swap" rel="stylesheet">

    <title>Joke Generator</title>
</head>
<body>
    <div class="container">
     <h1>Random Joke Generator</h1>
     <p id="joke">Click the button to get the joke.</p>
     <p id="jokeEmoji">ðŸ˜‚</p>
     <button id="getJoke" class="getJoke">Ready to laugh.</button>
    </div>


    <script>
     const jokeElement = document.getElementById("joke");
     const jokeBtn = document.getElementById("getJoke");
     const jokeEmoji = document.getElementById("jokeEmoji");

     jokeBtn.addEventListener('click',() => {
        let dots = 0;
        
        jokeEmoji.style.display = "none";
        //previous jokes lai hide garchha
        jokeElement.classList.remove("loaded");


        // Start with initial loading text
        jokeElement.style.opacity = "1"; // Make it visible immediately
        jokeElement.textContent = "Fetching a joke...";


        // Show fetching message
        // fetchingMessage.classList.remove("hidden");  
   
        const loadingInterval = setInterval(() =>{
            jokeElement.textContent = "Fetching a joke" + ".".repeat(dots % 4);
            dots++;
        }, 500);
       jokeElement.classList.remove("loaded");

        //using promises with fetch
        setTimeout(() => {
            fetch("https://official-joke-api.appspot.com/random_joke")
              .then(response =>{
                console.log(response);
                   if(!response.ok){
                     throw new Error("Network error");
                    }
                 return response.json();
                })

            .then(data=>{
                clearInterval(loadingInterval);
                // fetchingMessage.classList.add("hidden");

               setTimeout(()=>{
                jokeElement.textContent = `${data.setup} ðŸ¤£ ${data.punchline}`;
                jokeElement.classList.add("loaded");
                jokeEmoji.style.display = "block";
              }, 500); //transistion play garna help garchha 
            })
        .catch(error =>{
            clearInterval(loadingInterval);
                // fetchingMessage.classList.add("hidden");
                jokeElement.textContent = "Failed to fetch joke. Try again.";
                jokeElement.classList.add("loaded");
                console.error(error);
            });
         }, 1000);
    });
        
    </script>
</body>
</html>